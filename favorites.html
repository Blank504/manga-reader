<!-- @format -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Favorites</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Navbar -->
    <div class="navbar" id="navbar">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li>
          <a href="favorites.html" id="favorites-link" style="display: none"
            >Favorites</a
          >
        </li>
        <li><a href="login.html" id="login-link">Login</a></li>
        <li><a href="signup.html" id="signup-link">Signup</a></li>
        <li><a href="#" id="logout-link" style="display: none">Logout</a></li>
      </ul>
    </div>

    <header>
      <h1>Your Favorites</h1>
    </header>
    <main>
      <div id="favorites-grid" class="grid"></div>
    </main>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        fetch("check_session.php")
          .then((response) => response.json())
          .then((data) => {
            if (!data.logged_in) {
              alert("Please log in to view favorites!");
              window.location.href = "login.html";
            } else {
              fetchFavorites();
            }
          });
      });

      function fetchFavorites() {
        fetch("fetch_favorite_manga.php")
          .then((response) => response.json())
          .then((data) => {
            const favoritesGrid = document.getElementById("favorites-grid");
            data.forEach((manga) => {
              const card = document.createElement("div");
              card.className = "card";
              card.innerHTML = `
              <h3>${manga.title}</h3>
              <button onclick="removeFavorite('${manga.id}')">Remove</button>
            `;
              favoritesGrid.appendChild(card);
            });
          });
      }
    </script>
  </body>
</html>
